@model System.Data.DataTable
@using System.Data
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var tableName = ViewBag.TableName as string;
}

<div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
        <div class="card-body">
            <h4 class="card-title">@tableName</h4>
            <div class="container">
              
                <div class="container">
                    <h2>Download Table Template</h2>
                    <form method="get" asp-controller="Catalogue" asp-action="DownloadTemplate">
                        <div class="form-group">
                            <label for="tableName">@tableName</label>
                            <input type="text" value="@tableName" class="form-control" id="tableName" name="tableName" required />
                        </div>
                        <button type="submit" class="btn btn-primary">Download Template</button>
                    </form>
                </div>

                <h2>Upload File</h2>
                <form asp-controller="Catalogue" asp-action="UploadFile" asp-route-tablename="@tableName" enctype="multipart/form-data" method="post">
                    <div class="form-group">
                        <label for="file">Select file to upload (xlsx or csv):</label>
                        <input type="file" name="file" class="form-control" required />
                    </div>
                    <button type="submit" class="btn btn-primary mt-2">Upload</button>
                </form>
            </div>
            <div class="mb-3">
                <form asp-controller="Catalogue" asp-action="AddColumn" method="post" class="d-inline">
                    <input type="hidden" name="tableName" value="@tableName" />
                    <input type="text" name="columnName" placeholder="New Column Name" required />
                    <select name="columnType" required>
                        <option value="int">INT</option>
                        <option value="nvarchar(100)">NVARCHAR(100)</option>
                        <option value="datetime">DATETIME</option>
                        <!-- Add more types as needed -->
                    </select>
                    <button type="submit" class="btn btn-primary">Add Column</button>
                </form>
                <form asp-controller="Catalogue" asp-action="DeleteColumn" method="post" class="d-inline">
                    <input type="hidden" name="tableName" value="@tableName" />
                    <select name="columnName" required>
                        @foreach (DataColumn column in Model.Columns)
                        {
                            <option value="@column.ColumnName">@column.ColumnName</option>
                        }
                    </select>
                    <button type="submit" class="btn btn-danger">Delete Column</button>
                </form>
            </div>
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            @foreach (DataColumn column in Model.Columns)
                            {
                                <th>@column.ColumnName</th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (DataRow row in Model.Rows)
                        {
                            <tr>
                                @foreach (DataColumn column in Model.Columns)
                                {
                                    <td>@row[column.ColumnName]</td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="mt-3">
                <form asp-controller="Catalogue" asp-action="AddData" method="post">
                    <input type="hidden" name="tableName" value="@tableName" />
                    @foreach (DataColumn column in Model.Columns)
                    {
                        if (@column.ColumnName.Contains("CreatedDate"))
                        {

                        }
                        else
                        {
                            <input type="text" name="data[@column.ColumnName]" placeholder="@column.ColumnName" required />
                        }
                    }
                    <button type="submit" class="btn btn-primary">Add Data</button>
                </form>
            </div>
        </div>
    </div>
</div>
